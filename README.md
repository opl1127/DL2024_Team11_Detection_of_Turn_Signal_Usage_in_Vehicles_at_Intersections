# Deep Learning 期末專案
## 路口方向燈偵測

## 背景
隨著城市化的進程加快，交通問題日益突出。交通信號燈在維持交通秩序和提高交通效率方面起著重要作用。特別是路口的方向燈（左轉燈、直行燈、右轉燈）對於確保行車安全和減少交通事故至關重要。因此，開發一個能夠自動識別路口方向燈狀態的系統，有助於提升交通管理水平。

## 目標
設計並實現一個基於計算機視覺的路口方向燈偵測系統，能夠自動識別路口車輛狀態（左轉、直行、右轉），以及路口車輛方向燈狀態（正確施打方向燈，未正確施打方向燈）。

## 主要內容
1. **數據收集與標註**
- 收集包含不同天氣條件和時間段的路口方向燈圖片和視頻數據。
- 標註數據集，標記每張圖片中的方向燈狀態（左轉燈、直行燈、右轉燈）。

2. **影像處理與特徵提取**
- 將影片分幀。
- 使用 labelImg，提取方向燈區域。
- 使用深度學習模型（Yolo v8）進行方向燈狀態的識別。

3. **模型訓練與評估**
- 使用標註好的數據集訓練模型，調整參數以提高準確性。
- 在測試集上評估模型性能，確保其在實際應用中的可靠性。

## 使用工具
- **數據標註工具**: labelImg
- **深度學習模型**: Yolo v8
- **編程語言**: Python
- **硬體配置**: 
	- CPU: Intel Core i5-13400
	- GPU: NVIDIA GeForce RTX 4060

## 數據集
本專案所使用的數據集是由學校提供，目的是用於開發和訓練自動識別路口方向燈狀態的系統。
數據集包含了在不同天氣條件和時間段拍攝的圖片和影片。

## dataset放置方式
	project-root/
	├── data/
	│   ├── images/
	│   │   ├── train/
	│   │   │   ├── image1.jpg
	│   │   │   └── image2.jpg
	│   │   ├── val/
	│   │       ├── image1.jpg
	│   │       └── image2.jpg
	│   ├── labels/
	│   │   ├── train/
	│   │   │   ├── image1.txt
	│   │   │   └── image2.txt
	│   │   ├── val/
	│   │       ├── image1.txt
	│   │       └── image2.txt

## 標註處理方式
在本專案中，我們的標註方式包括兩個步驟。首先，我們標示出整台右轉或左轉的車輛。
接著，針對這些右轉或左轉的車輛，我們進行進一步的標註，框出車尾的方向燈，以辨識是否正確施打方向燈。
- 以下是具體的標註處理步驟：
1.	標示車輛方向
	- 首先，對每張圖片中的車輛進行標註，標明其行駛方向（左轉或右轉）。
	- 使用標註工具(labelImg)框出每輛車的位置，並附上標籤(右轉或左轉)。
2.	框出車尾方向燈
	- 對於已標註為左轉或右轉的車輛，再次使用標註工具框出車尾方向燈的位置。
	- 標註方向燈的狀態(右轉車輛有打方向燈 或 右轉車輛未打方向燈)，以表明該車輛是否正確施打了右轉方向燈。

## 判斷車輛是否正確施打方向燈
在本專案中，我們需要判斷車輛在轉彎時是否正確施打了方向燈。具體判斷邏輯如下：

1.	判斷右轉車輛方向燈
-	如果在影片中檢測到某輛車輛右轉，並且在任意一幀中檢測到該車輛正確施打右轉方向燈，則判定該右轉車輛正確施打了方向燈。
-	如果檢測到某輛車輛右轉，但在所有幀中均未檢測到該車輛正確施打右轉方向燈，則判定該右轉車輛未正確施打方向燈。
2.	判斷左轉車輛方向燈
-	如果在影片中檢測到某輛車輛左轉，並且在任意一幀中檢測到該車輛正確施打左轉方向燈，則判定該左轉車輛正確施打了方向燈。
-	如果檢測到某輛車輛左轉，但在所有幀中均未檢測到該車輛正確施打左轉方向燈，則判定該左轉車輛未正確施打方向燈。


## 檔案介紹
- data.yaml(設定資料路徑以及標籤內容)
- train.py(訓練腳本)
- vedio_inference.py(使用訓練完的模型進行推理)
- result.py(結果驗證)
- best.pt(訓練權重檔案)


## 如何訓練
1. 安裝 pip install ultralytics
2. 依照上面格式將dataset整理好
3. 更改 data.yaml
4. 更改train.py並執行

## 如何使用
1. 更改 vedio_inference.py
2. 執行 python vedio_inference.py > output.txt 將執行結果保存在txt檔案中

## 驗證結果
1. 更改 result.py 
2. 執行 result.py 來檢測訓練結果



## 參考資料
https://henry870603.medium.com/object-detection-yolov8%E8%A9%B3%E8%A7%A3-fdf8874e5e99
https://ithelp.ithome.com.tw/articles/10332185?sc=rss.iron
https://hackmd.io/@luckychi/yolov8_simple_tutorial
https://blog.csdn.net/qq_40716944/article/details/128648001
